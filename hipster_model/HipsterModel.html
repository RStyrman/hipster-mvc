        <!DOCTYPE html>
        <html>
        <head>
                <meta charset="utf-8">
        <title>HipsterModel class / hipster_model Library / Hipster MVC</title>
        <link rel="stylesheet" type="text/css"
            href="../styles.css">
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800" rel="stylesheet" type="text/css">
        <link rel="shortcut icon" href="../favicon.ico">
        
        </head>
        <body data-library="hipster_model" data-type="HipsterModel">
        <div class="page">
        <div class="header">
          <a href="../index.html"><div class="logo"></div></a>
          <a href="../index.html">Hipster MVC</a>
         &rsaquo; <a href="../hipster_model.html">hipster_model</a> &rsaquo; <a href="../hipster_model/HipsterModel.html">HipsterModel</a>        <div id="search-box">
          <input type="search" name="q" id="q" autocomplete="off"
              class="search-input" placeholder="Search API">
        </div>
        
      </div>
      <div class="drop-down" id="drop-down"></div>
      
        <div class="nav">
        
</div>
<div class="content">
        <h2><strong>HipsterModel</strong>
          class
        </h2>
        
<button id="show-inherited" class="show-inherited">Hide inherited</button>
<div class="doc">
<p>HipsterModel encapsulates individual records in your backend datastore. At
its most concise, a model need only to implement the <a class="crossref" href="../hipster_model/HipsterModel.html#urlRoot">urlRoot</a> method:</p>
<pre><code>class ComicBook extends HipsterModel {
  get urlRoot =&gt; '/comics';
}
</code></pre>
<pre class="source">
class HipsterModel implements Hashable {
  /** The internal representation of the record. */
  Map attributes;

  /**
   * An [Events] object for the model. Any internal changes to the model will
   * broadcast events from this object.  See [ModelEvents] for the complete
   * list of events supported.
   */
  ModelEvents on;

  /** If the model is part of a collection, it will be stored here. */
  Collection collection;

  /**
   * If attributes is not supplied, it will be initalied to an empty
   * [HashMap].
   */
  HipsterModel([this.attributes]) {
    on = new ModelEvents();
    if (attributes == null) attributes = {};
  }

  // TODO: better hashing function (delimited keys and values?)
  static String hash() {
    return (new Date.now()).value.hashCode().toRadixString(16);
  }

  /**
   * Convenience operator for attribute lookup:
   *
   *     var comic = new ComicBook({'title': 'Superman'});
   *     comic['title'];
   *     // =&gt; 'Superman'
   */
  operator [](attr) =&gt; attributes[attr];

  /** The ID of the record in the backend store. */
  get id =&gt; attributes['id'];

  /**
   * The URL at which creates or updates are stored. If the model has already
   * been saved to the backend, then the ID will be appended
   * (e.g. `/comics/42`).
   */
  String get url =&gt; isSaved() ?
    "$urlRoot/$id" : urlRoot;

  /**
   * The base URL for REST-like operations _without_ the trailing slash
   * (e.g. `/comics`). This is delegated to the collection if present.
   *
   * If the subclass is ever used without a collection, then the subclass is
   * required to define this:
   *     class ComicBook extends HipsterModel {
   *       get urlRoot =&gt; '/comics';
   *     }
   */
  String get urlRoot =&gt; (collection == null) ?
    "" : collection.url;

  /**
   * Returns true if the model has been _previously_ saved to the backend (not
   * if the most recent changes have been saved).
   */
  bool isSaved() =&gt; id != null;

  /**
   * Either creates or updates this record in the backend datastore. This
   * method returns a [Future] that can be used to perform subsequent actions
   * upon successful save:
   *     comic.
   *       save().
   *       then((_) { print("Yay! New comics!"); });
   */
  Future&lt;HipsterModel&gt; save() {
    Completer completer = new Completer();
    String operation = isSaved() ? 'update' : 'create';
    Future after_call = HipsterSync.call(operation, this);

    after_call.
      then((attrs) {
        this.attributes = attrs;
        on.load.dispatch(new ModelEvent('save', this));
        completer.complete(this);
      });

    after_call.
      handleException((e) {
        completer.completeException(e);
        return true;
      });

    return completer.future;
  }

  /**
   * Instructs the backend datastore that this recored should be deleted. Upon
   * successful removal, this method returns a [Future] that can be used to
   * perform subsequent action:
   *     comic.
   *       delete.
   *       then((_) { print("Now I am sad.") });
   */
  Future&lt;HipsterModel&gt; delete() {
    Completer completer = new Completer();

    HipsterSync.
      call('delete', this).
      then((attrs) {
        var event = new ModelEvent('delete', this);
        on.delete.dispatch(event);

        completer.complete(this);
      });

    return completer.future;
  }

}
</pre>
</div>
<h3>Implements</h3>
<p>
<span class="type-box"><span class="icon-class"></span><a href="../dart_core/Hashable.html">Hashable</a></span></p>
<div>
<h3>Static Methods</h3>
<div class="method"><h4 id="hash">
<button class="show-code">Code</button>
String <strong>hash</strong>() <a class="anchor-link" href="#hash"
              title="Permalink to HipsterModel.hash">#</a></h4>
<div class="doc">
<pre class="source">
static String hash() {
  return (new Date.now()).value.hashCode().toRadixString(16);
}
</pre>
</div>
</div>
</div>
<div>
<h3>Constructors</h3>
<div class="method"><h4 id="HipsterModel">
<button class="show-code">Code</button>
new <strong>HipsterModel</strong>([Map attributes]) <a class="anchor-link" href="#HipsterModel"
              title="Permalink to HipsterModel.HipsterModel">#</a></h4>
<div class="doc">
<p>If attributes is not supplied, it will be initalied to an empty
<code>HashMap</code>.</p>
<pre class="source">
HipsterModel([this.attributes]) {
  on = new ModelEvents();
  if (attributes == null) attributes = {};
}
</pre>
</div>
</div>
</div>
<div>
<h3>Properties</h3>
<div class="field"><h4 id="attributes">
<button class="show-code">Code</button>
Map         <strong>attributes</strong> <a class="anchor-link"
            href="#attributes"
            title="Permalink to HipsterModel.attributes">#</a>
        </h4>
        <div class="doc">
<p>The internal representation of the record.</p>
<pre class="source">
Map attributes;
</pre>
</div>
</div>
<div class="field"><h4 id="collection">
<button class="show-code">Code</button>
Collection         <strong>collection</strong> <a class="anchor-link"
            href="#collection"
            title="Permalink to HipsterModel.collection">#</a>
        </h4>
        <div class="doc">
<p>If the model is part of a collection, it will be stored here.</p>
<pre class="source">
Collection collection;
</pre>
</div>
</div>
<div class="field inherited"><h4 id="hashCode">
<button class="show-code">Code</button>
final int         <strong>hashCode</strong> <a class="anchor-link"
            href="#hashCode"
            title="Permalink to HipsterModel.hashCode">#</a>
        </h4>
        <div class="inherited-from">inherited from Hashable </div><div class="doc">
<div class="inherited">
<p>Get a hash code for this object.</p>
<p>All objects have hash codes. Hash codes are guaranteed to be the
same for objects that are equal when compared using the equality
operator <code>==</code>. Other than that there are no guarantees about
the hash codes. They will not be consistent between runs and
there are no distribution guarantees.</p>
<p>If a subclass overrides <code>hashCode</code> it should override the
equality operator as well to maintain consistency.</p>
<div class="docs-inherited-from">docs inherited from Object </div></div>
<pre class="source">
abstract int get hashCode;
</pre>
</div>
</div>
<div class="field"><h4 id="id">
<button class="show-code">Code</button>
final         <strong>id</strong> <a class="anchor-link"
            href="#id"
            title="Permalink to HipsterModel.id">#</a>
        </h4>
        <div class="doc">
<p>The ID of the record in the backend store.</p>
<pre class="source">
get id =&gt; attributes['id'];
</pre>
</div>
</div>
<div class="field"><h4 id="on">
<button class="show-code">Code</button>
<a href="../hipster_model/ModelEvents.html">ModelEvents</a>         <strong>on</strong> <a class="anchor-link"
            href="#on"
            title="Permalink to HipsterModel.on">#</a>
        </h4>
        <div class="doc">
<p>An <code>Events</code> object for the model. Any internal changes to the model will
broadcast events from this object.  See <a class="crossref" href="../hipster_model/ModelEvents.html">ModelEvents</a> for the complete
list of events supported.</p>
<pre class="source">
ModelEvents on;
</pre>
</div>
</div>
<div class="field"><h4 id="url">
<button class="show-code">Code</button>
final String         <strong>url</strong> <a class="anchor-link"
            href="#url"
            title="Permalink to HipsterModel.url">#</a>
        </h4>
        <div class="doc">
<p>The URL at which creates or updates are stored. If the model has already
been saved to the backend, then the ID will be appended
(e.g. <code>/comics/42</code>).</p>
<pre class="source">
String get url =&gt; isSaved() ?
  "$urlRoot/$id" : urlRoot;
</pre>
</div>
</div>
<div class="field"><h4 id="urlRoot">
<button class="show-code">Code</button>
final String         <strong>urlRoot</strong> <a class="anchor-link"
            href="#urlRoot"
            title="Permalink to HipsterModel.urlRoot">#</a>
        </h4>
        <div class="doc">
<p>The base URL for REST-like operations <em>without</em> the trailing slash
(e.g. <code>/comics</code>). This is delegated to the collection if present.</p>
<p>If the subclass is ever used without a collection, then the subclass is
required to define this:</p>
<pre><code>class ComicBook extends HipsterModel {
  get urlRoot =&gt; '/comics';
}
</code></pre>
<pre class="source">
String get urlRoot =&gt; (collection == null) ?
  "" : collection.url;
</pre>
</div>
</div>
</div>
<div>
<h3>Operators</h3>
<div class="method"><h4 id="[]">
<button class="show-code">Code</button>
<strong>operator []</strong>(attr) <a class="anchor-link" href="#[]"
              title="Permalink to HipsterModel.operator []">#</a></h4>
<div class="doc">
<p>Convenience operator for attribute lookup:</p>
<pre><code>var comic = new ComicBook({'title': 'Superman'});
comic['title'];
// =&gt; 'Superman'
</code></pre>
<pre class="source">
operator [](attr) =&gt; attributes[attr];
</pre>
</div>
</div>
</div>
<div>
<h3>Methods</h3>
<div class="method"><h4 id="delete">
<button class="show-code">Code</button>
Future&lt;<a href="../hipster_model/HipsterModel.html">HipsterModel</a>&gt; <strong>delete</strong>() <a class="anchor-link" href="#delete"
              title="Permalink to HipsterModel.delete">#</a></h4>
<div class="doc">
<p>Instructs the backend datastore that this recored should be deleted. Upon
successful removal, this method returns a <code>Future</code> that can be used to
perform subsequent action:</p>
<pre><code>comic.
  delete.
  then((_) { print("Now I am sad.") });
</code></pre>
<pre class="source">
Future&lt;HipsterModel&gt; delete() {
  Completer completer = new Completer();

  HipsterSync.
    call('delete', this).
    then((attrs) {
      var event = new ModelEvent('delete', this);
      on.delete.dispatch(event);

      completer.complete(this);
    });

  return completer.future;
}
</pre>
</div>
</div>
<div class="method"><h4 id="isSaved">
<button class="show-code">Code</button>
bool <strong>isSaved</strong>() <a class="anchor-link" href="#isSaved"
              title="Permalink to HipsterModel.isSaved">#</a></h4>
<div class="doc">
<p>Returns true if the model has been <em>previously</em> saved to the backend (not
if the most recent changes have been saved).</p>
<pre class="source">
bool isSaved() =&gt; id != null;
</pre>
</div>
</div>
<div class="method"><h4 id="save">
<button class="show-code">Code</button>
Future&lt;<a href="../hipster_model/HipsterModel.html">HipsterModel</a>&gt; <strong>save</strong>() <a class="anchor-link" href="#save"
              title="Permalink to HipsterModel.save">#</a></h4>
<div class="doc">
<p>Either creates or updates this record in the backend datastore. This
method returns a <code>Future</code> that can be used to perform subsequent actions
upon successful save:</p>
<pre><code>comic.
  save().
  then((_) { print("Yay! New comics!"); });
</code></pre>
<pre class="source">
Future&lt;HipsterModel&gt; save() {
  Completer completer = new Completer();
  String operation = isSaved() ? 'update' : 'create';
  Future after_call = HipsterSync.call(operation, this);

  after_call.
    then((attrs) {
      this.attributes = attrs;
      on.load.dispatch(new ModelEvent('save', this));
      completer.complete(this);
    });

  after_call.
    handleException((e) {
      completer.completeException(e);
      return true;
    });

  return completer.future;
}
</pre>
</div>
</div>
</div>
        </div>
        <div class="clear"></div>
        </div>
        
        <div class="footer">
          <div>This page was generated at 2012-11-02 23:56:22.259</div>
        </div>
        <script async src="../client-live-nav.js"></script>
        </body></html>
        
